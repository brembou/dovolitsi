<style>
    html {
        scroll-behavior: smooth;
    }
    
    /* 1. CLS FIX: Rezervace místa, aby stránka neposkočila */
    .gh-toc {
        margin: 1rem 0 0.5rem;
        min-height: 200px;
        counter-reset: h2;
    }

    .gh-content h2, 
    .gh-content h3 {
        scroll-margin-top: 30px; 
        outline: none; /* Pro jistotu odstraníme focus rámečky po kliku */
    }

    /* Reset seznamu */
    .gh-toc ol {
        list-style: none;
        margin: 0;
        padding: 0;
    }

    .gh-toc .toc-list,
    .gh-toc .toc-list.is-collapsible {
        margin: 0.5rem 0 0;
    }

    .gh-toc .toc-list .toc-list {
        padding-left: 25px;
    }

    .toc-list-item {
        line-height: 1.4;
        padding-bottom: 4px;
    }

    .gh-toc>ol>li {
        counter-increment: h2;
        counter-reset: h3;
        margin: 0.3em 0;
    }

    .gh-toc>ol>li::before {
        content: counter(h2) ". ";
        font-weight: bold;
        margin-right: 0.3em;
    }

    .gh-toc>ol>li>ol>li {
        counter-increment: h3;
        margin: 0.2em 0 0.2em 0;
    }

    .gh-toc>ol>li>ol>li::before {
        content: counter(h2) "." counter(h3) ". ";
        font-weight: bold;
        margin-right: 0.3em;
    }
</style>

<script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.12.3/tocbot.min.js" defer></script>
<script>
    function initToc() {
        if (!window.tocbot) return;

        tocbot.init({
            tocSelector: '.gh-toc',
            contentSelector: '.gh-content',
            headingSelector: 'h2, h3',
            ignoreSelector: '.no-toc',
            orderedList: true,
            scrollSmooth: false,
            headingsOffset: 30,      
        });

        // Logika pro skrytí prázdného boxu
        var tocDiv = document.querySelector('.gh-toc');
        var list = tocDiv ? tocDiv.querySelector('.toc-list') : null;

        if (!list || list.children.length === 0) {
            var wrapper = tocDiv.closest('.bg-gray-100'); 
            if (wrapper) wrapper.style.display = 'none';
            else tocDiv.style.display = 'none';
        }
    }

    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initToc);
    } else {
        initToc();
    }
</script>